<script>

// ==========================
// UTILIDADES
// ==========================
const qs = (id)=>document.getElementById(id);
const toNum = (v)=> Number(String(v).replace(',', '.'));
const fmt = (n, d=2)=> (Number.isFinite(n) ? n.toFixed(d).replace('.', ',') : '—');

// ==========================
// BASE AGRUPADA INTELIGENTE
// ==========================
const PRODUCTS = [

{
  name:"5-Amino-1MQ",
  unit:"MG",
  doses:[5,10,50]
},

{
  name:"BPC-157",
  unit:"MG",
  doses:[2,5,10,15,20,50,70,80]
},

{
  name:"TB-500",
  unit:"MG",
  doses:[2,5,10,20]
},

{
  name:"Retatrutide",
  unit:"MG",
  doses:[5,10,15,20,25,30,35,40,50,60,100]
},

{
  name:"Tirzepatide",
  unit:"MG",
  doses:[2,5,10,15,20,30,40,45,50,60,70,80,90,100,110,120]
},

{
  name:"Semaglutide",
  unit:"MG",
  doses:[2,5,10,15,20,30,50]
},

{
  name:"Liraglutide",
  unit:"MG",
  doses:[5,10,30]
},

{
  name:"Mazdutide",
  unit:"MG",
  doses:[5,10,20]
},

{
  name:"HCG",
  unit:"IU",
  doses:[1000,2000,5000,10000]
},

{
  name:"HGH (191AA)",
  unit:"IU",
  doses:[6,8,10,12,15,24,36,40,50]
},

{
  name:"IGF-1 DES",
  unit:"MCG",
  doses:[100]
},

{
  name:"IGF-1 LR3",
  unit:"MG",
  doses:[1]
},

{
  name:"Ipamorelin",
  unit:"MG",
  doses:[2,5,10]
},

{
  name:"CJC-1295 (no DAC)",
  unit:"MG",
  doses:[2,5,10]
},

{
  name:"CJC-1295 (with DAC)",
  unit:"MG",
  doses:[2,5,10]
},

{
  name:"DSIP",
  unit:"MG",
  doses:[2,5,10,12,15]
},

{
  name:"Epithalon",
  unit:"MG",
  doses:[5,10,40,50]
},

{
  name:"GHK-Cu",
  unit:"MG",
  doses:[10,50,100]
},

{
  name:"GHRP-2",
  unit:"MG",
  doses:[5,10,15]
},

{
  name:"GHRP-6",
  unit:"MG",
  doses:[5,10]
},

{
  name:"NAD+",
  unit:"MG",
  doses:[100,500,1000]
},

{
  name:"Oxytocin",
  unit:"MG",
  doses:[2,5,10]
},

{
  name:"PT-141",
  unit:"MG",
  doses:[10]
},

{
  name:"Tesamorelin",
  unit:"MG",
  doses:[2,5,10,15,20]
},

{
  name:"Thymosin Alpha-1",
  unit:"MG",
  doses:[2,5,10,12,15]
},

{
  name:"Vitamin D3",
  unit:"IU",
  doses:[20000]
}

];

// ==========================
// BUILD SELECT DINÂMICO
// ==========================
function buildProductSelect(){

  const select = qs('preset');
  select.innerHTML = '';

  const custom = document.createElement('option');
  custom.value = 'custom';
  custom.textContent = 'Personalizado';
  select.appendChild(custom);

  PRODUCTS.forEach((product, productIndex)=>{

    product.doses.forEach(dose=>{
      const opt = document.createElement('option');
      opt.value = `${productIndex}_${dose}`;
      opt.textContent = `${product.name} (${dose} ${product.unit})`;
      select.appendChild(opt);
    });

  });

}

// ==========================
// SET PRESET
// ==========================
function setPreset(){

  const value = qs('preset').value;

  if(value === 'custom'){
    update();
    return;
  }

  const [productIndex, dose] = value.split('_');
  const product = PRODUCTS[productIndex];

  if(!product){
    update();
    return;
  }

  if(product.unit === 'MG'){
    qs('vialMg').value = dose;
  }

  if(product.unit === 'MCG'){
    qs('vialMg').value = dose / 1000;
  }

  if(product.unit === 'IU' || product.unit === 'ML'){
    qs('vialMg').value = '';
  }

  update();
}

// ==========================
// INICIALIZAÇÃO
// ==========================
buildProductSelect();

</script>
